<!-- Login / Register-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forum Page</title>
</head>

<body>

    <div id="loginForm">
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">
        <button id="loginButton">Log In</button>
        <ul id="loginErrors">

        </ul>
    </div>

    <script>
        const baseUrl = "http://localhost:3000"; // Replace with the actual API base URL after backend deployment
        let token = ""; // Store the token received after successful login

        const loginForm = document.getElementById("loginForm");
        const loginButton = document.getElementById("loginButton");
        const loginErrors = document.getElementById("loginErrors");


        // Event listeners
        loginButton.addEventListener("click", async (e) => {
            e.preventDefault();

            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;

            const response = await fetch(`${baseUrl}/auth/passport/login`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ username, password })
            });
            let body = response.body;

            let res = await response.json()
            console.log(res)

            if (!res.error) {
                // const data = await response.json();
                token = res.token;
                loginForm.style.display = "none";
                postForm.style.display = "block";
                commentForm.style.display = "block";
                // fetchAndDisplayPosts();//removed when separated: user's login token will be used 
            } else {
                // let error = document.createElement("li");
                loginErrors.innerHTML = `${res.error}`;
                // loginErrors.append(error);
            }
            //  else {
            //     alert("Login failed. Please check your credentials.");
            // }
        });


    </script>
</body>

</html>
